// map.js â€“ GeoJSON Loader for Far North District Alerts
(function (global) {
  const GEOJSON_KEY = "farNorthGeoJSON";
  const GEOJSON_TIMESTAMP_KEY = "farNorthGeoJSON_timestamp";
  const GEOJSON_EXPIRY_HOURS = 24;

  // Embedded fallback GeoJSON (truncated for brevity)
  const embeddedGeoJSON = {"type":"FeatureCollection","features":[{"type":"Feature","properties":{"Name":"Far North District 1","TA2022_V1_00":"001","TA2022_V1_00_NAME":"Far North District","TA2022_V1_00_NAME_ASCII":"Far North District","LAND_AREA_SQ_KM":6686.666770239993,"AREA_SQ_KM":7322.473550879995,"Shape_Length":875595.6394183529},"geometry":{"type":"MultiPolygon","coordinates":[[[[173.160619,-35.311454],[173.160236,-35.310268],[173.160056,-35.311313],[173.160619,-35.311454]]],[[[173.934039,-35.058769],[173.935218,-35.057867],[173.934571,-35.057986],[173.934039,-35.058769]]],[[[173.940192,-35.054714],[173.940081,-35.053413],[173.939479,-35.054493],[173.940192,-35.054714]]],[[[173.944864,-35.031119],[173.942894,-35.032362],[173.946128,-35.031695],[173.944864,-35.031119]]],[[[173.955819,-35.030521],[173.9516,-35.030673],[173.95141,-35.033342],[173.956562,-35.034692],[173.965534,-35.032046],[173.955819,-35.030521]]],[[[173.937362,-35.029938],[173.937761,-35.029446],[173.936598,-35.02942],[173.937362,-35.029938]]],[[[173.93482,-35.028543],[173.933074,-35.029673],[173.935146,-35.030298],[173.93482,-35.028543]]],[[[173.951659,-35.024838],[173.949235,-35.025033],[173.95208,-35.025837],[173.951659,-35.024838]]],[[[173.949168,-35.023203],[173.948708,-35.021306],[173.948211,-35.022455],[173.949168,-35.023203]]],[[[173.950915,-35.017931],[173.950513,-35.017004],[173.950413,-35.017752],[173.950915,-35.017931]]],[[[173.950572,-35.018656],[173.949181,-35.016716],[173.94872,-35.017653],[173.950572,-35.018656]]],[[[173.865552,-35.011857],[173.863818,-35.012113],[173.864775,-35.012597],[173.865552,-35.011857]]],[[[173.935919,-35.011211],[173.935913,-35.010948],[173.93571,-35.010962],[173.935919,-35.011211]]],[[[173.948744,-35.011074],[173.948893,-35.010818],[173.948169,-35.010736],[173.948744,-35.011074]]],[[[173.858358,-35.011228],[173.858457,-35.011091],[173.858106,-35.011119],[173.858358,-35.011228]]],[[[173.948868,-35.003115],[173.948948,-35.002703],[173.948277,-35.00285],[173.948868,-35.003115]]],[[[173.962435,-34.999548],[173.962453,-34.998664],[173.961824,-34.999163],[173.962435,-34.999548]]],[[[173.968911,-34.998942],[173.965132,-34.999357],[173.971887,-35.003685],[173.97317,-35.001547],[173.968911,-34.998942]]],[[[173.931862,-34.997744],[173.931877,-34.997198],[173.931657,-34.997637],[173.931862,-34.997744]]],[[[173.952784,-34.995301],[173.952686,-34.994786],[173.952349,-34.994895],[173.952784,-34.995301]]],[[[173.841806,-34.99354],[173.842685,-34.993053],[173.841642,-34.993403],[173.841806,-34.99354]]],[[[173.823379,-34.992915],[173.823465,-34.99233],[173.82281,-34.992741],[173.823379,-34.992915]]],[[[173.8536,-34.992224],[173.853472,-34.992022],[173.853389,-34.992228],[173.8536,-34.992224]]],[[[173.798359,-34.993431],[173.798909,-34.992368],[173.798232,-34.992461],[173.798359,-34.993431]]],[[[173.85319,-34.991225],[173.85321,-34.991003],[173.853059,-34.991175],[173.85319,-34.991225]]],[[[173.861709,-34.990468],[173.861859,-34.990214],[173.861574,-34.990364],[173.861709,-34.990468]]],[[[173.818333,-34.991783],[173.817431,-34.98847],[173.817573,-34.990852],[173.818333,-34.991783]]],[[[173.862659,-34.987854],[173.863866,-34.986038],[173.861575,-34.986388],[173.862659,-34.987854]]],[[[173.954862,-34.986145],[173.95038,-34.985969],[173.943954,-34.989573],[173.938944,-34.987383],[173.940291,-34.989404],[173.938237,-34.992901],[173.932208,-34.997685],[173.93033,-35.005465],[173.935863,-35.005942],[173.936137,-35.010694],[173.94215,-35.011106],[173.942673,-35.016663],[173.949051,-35.016612],[173.94798,-35.010753],[173.945389,-35.010971],[173.944811,-35.008224],[173.948262,-35.00031],[173.950994,-35.000123],[173.950141,-34.996648],[173.952181,-34.994861],[173.94966,-34.990552],[173.954862,-34.986145]]],[[[173.972967,-34.981294],[173.972364,-34.981985],[173.973727,-34.980967],[173.972967,-34.981294]]],[[[173.95696,-34.981782],[173.956204,-34.980303],[173.954099,-34.981203],[173.95696,-34.981782]]],[[[173.439718,-34.981485],[173.437775,-34.980814],[173.438578,-34.982048],[173.439718,-34.981485]]],[[[173.962058,-34.976623],[173.962191,-34.976228],[173.96186,-34.975978],[173.962058,-34.976623]]],[[[173.947378,-34.975557],[173.945857,-34.974358],[173.942553,-34.976339],[173.947378,-34.975557]]],[[[173.86733,-34.978226],[173.86455,-34.974553],[173.861407,-34.977118],[173.865106,-34.983319],[173.86733,-34.978226]]],[[[173.964009,-34.974],[173.962389,-34.974443],[173.964445,-34.978168],[173.966561,-34.975434],[173.964009,-34.974]]],[[[173.952861,-34.974298],[173.950207,-34.973247],[173.948582,-34.975215],[173.952915,-34.976997],[173.957619,-34.974853],[173.952861,-34.974298]]],[[[173.933994,-34.969202],[173.933203,-34.96971],[173.934159,-34.969978],[173.933994,-34.969202]]],[[[173.940963,-34.971799],[173.941761,-34.97053],[173.938868,-34.969424],[173.940963,-34.971799]]],[[[173.77757,-34.969919],[173.776932,-34.969568],[173.776815,-34.970058],[173.77757,-34.969919]]],[[[173.713197,-34.969421],[173.713313,-34.969231],[173.712808,-34.969339],[173.713197,-34.969421]]],[[[173.774793,-34.967152],[173.774492,-34.967479],[173.775535,-34.967578],[173.774793,-34.967152]]],[[[173.775229,-34.956032],[173.769386,-34.955573],[173.780295,-34.963371],[173.777705,-34.964182],[173.779165,-34.967681],[173.777144,-34.969479],[173.787751,-34.969865],[173.783756,-34.959582],[173.775229,-34.956032]]],[[[173.763845,-34.95178],[173.768608,-34.954882],[173.769759,-34.953266],[173.763845,-34.95178]]],[[[173.69133,-34.946022],[173.689669,-34.946678],[173.690879,-34.946742],[173.69133,-34.946022]]],[[[173.68938,-34.946356],[173.689454,-34.94576],[173.688728,-34.9461],[173.68938,-34.946356]]],[[[173.688535,-34.945801],[173.68834,-34.945577],[173.688353,-34.945892],[173.688535,-34.945801]]],[[[173.653258,-34.944837],[173.651476,-34.944965],[173.653995,-34.946572],[173.653258,-34.944837]]],[[[173.577127,-34.925222],[173.576871,-34.924285],[173.576648,-34.92506],[173.577127,-34.925222]]],[[[173.376712,-34.786342],[173.374689,-34.785218],[173.376825,-34.789162],[173.381626,-34.788161],[173.376712,-34.786342]]],[[[173.383718,-34.78364],[173.383885,-34.783416],[173.38356,-34.783035],[173.383718,-34.78364]]],[[[173.384416,-34.783279],[173.384296,-34.78293],[173.384247,-34.783216],[173.384416,-34.783279]]],[[[173.358816,-34.780784],[173.35709,-34.779516],[173.358849,-34.78256],[173.360608,-34.780883],[173.358816,-34.780784]]],[[[173.395234,-34.77785],[173.395271,-34.777598],[173.39507,-34.777421],[173.395234,-34.77785]]],[[[173.394634,-34.776801],[173.394475,-34.776409],[173.394537,-34.776744],[173.394634,-34.776801]]],[[[173.395241,-34.774709],[173.394626,-34.773947],[173.394494,-34.774294],[173.395241,-34.774709]]],[[[173.393065,-34.773762],[173.394798,-34.775708],[173.393927,-34.77399],[173.393065,-34.773762]]],[[[173.349529,-34.773313],[173.348981,-34.770942],[173.345291,-34.767777],[173.349529,-34.773313]]],[[[173.153041,-34.757094],[173.152465,-34.75635],[173.152662,-34.757005],[173.153041,-34.757094]]],[[[173.153578,-34.755435],[173.153275,-34.756768],[173.155857,-34.756964],[173.153578,-34.755435]]],[[[173.157434,-34.756573],[173.156423,-34.754807],[173.15497,-34.754737],[173.157434,-34.756573]]],[[[173.155706,-34.751294],[173.156156,-34.75095],[173.155577,-34.75091],[173.155706,-34.751294]]],[[[172.893384,-34.686944],[172.893168,-34.686224],[172.893185,-34.686826],[172.893384,-34.686944]]],[[[172.889387,-34.684788],[172.888579,-34.685761],[172.893029,-34.686787],[172.889387,-34.684788]]],[[[172.889787,-34.684633],[172.890102,-34.684479],[172.889225,-34.684503],[172.889787,-34.684633]]],[[[172.79918,-34.604767],[172.798184,-34.603352],[172.798076,-34.604717],[172.79918,-34.604767]]],[[[172.64091,-34.469365],[172.636488,-34.465599],[172.635279,-34.472724],[172.639908,-34.472973],[172.64091,-34.469365]]],[[[172.635702,-34.465722],[172.636617,-34.465004],[172.635788,-34.463818],[172.635702,-34.465722]]],[[[172.857178,-34.419565],[172.854902,-34.418541],[172.857948,-34.420091],[172.857178,-34.419565]]],[[[173.049645,-34.412738],[173.049033,-34.41613],[173.052077,-34.416196],[173.049645,-34.412738]]],[[[173.013246,-34.39263],[173.002709,-34.395955],[173.001324,-34.402175],[172.985764,-34.405247],[172.99291,-34.410766],[172.990355,-34.413966],[172.991219,-34.418021],[172.987253,-34.41691],[172.98171,-34.421411],[172.964131,-34.426464],[172.95957,-34.423729],[172.9356,-34.427539],[172.930816,-34.420533],[172.918435,-34.419036],[172.910566,-34.422264],[172.910761,-34.419358],[172.899466,-34.415475],[172.893488,-34.418834],[172.885684,-34.419235],[172.869035,-34.414519],[172.859441,-34.416458],[172.857671,-34.414045],[172.854471,-34.414789],[172.860305,-34.421046],[172.852487,-34.433206],[172.829125,-34.447317],[172.800252,-34.453669],[172.785556,-34.45283],[172.785361,-34.454467],[172.776342,-34.448213],[172.76884,-34.447933],[172.763944,-34.442888],[172.754365,-34.442935],[172.745882,-34.439748],[172.74613,-34.437915],[172.742665,-34.439007],[172.741948,-34.436905],[172.726565,-34.436275],[172.721049,-34.433709],[172.713048,-34.435617],[172.705829,-34.427254],[172.69518,-34.426259],[172.693612,-34.428726],[172.691184,-34.425401],[172.68255,-34.424817],[172.679898,-34.420397],[172.674601,-34.426496],[172.676867,-34.43072],[172.674125,-34.43662],[172.678362,-34.437869],[172.678383,-34.445268],[172.672134,-34.461012],[172.665544,-34.467143],[172.657608,-34.46697],[172.649647,-34.472973],[172.644998,-34.473188],[172.642832,-34.476522],[172.649166,-34.478721],[172.651255,-34.476374],[172.66049,-34.477363],[172.668739,-34.484546],[172.673235,-34.484021],[172.680487,-34.488018],[172.681345,-34.491149],[172.684855,-34.487303],[172.690262,-34.490572],[172.701999,-34.503697],[172.702606,-34.507153],[172.69794,-34.509935],[172.699448,-34.51148],[172.703335,-34.509739],[172.701925,-34.518742],[172.70383,-34.523455],[172.707886,-34.524704],[172.709975,-34.522887],[172.712519,-34.527624],[172.719332,-34.530069],[172.720133,-34.527515],[172.724907,-34.52648],[172.737949,-34.533477],[172.798002,-34.581526],[172.848432,-34.626914],[172.886713,-34.668301],[172.89414,-34.67898],[172.893546,-34.684622],[172.898284,-34.685579],[172.929212,-34.718906],[173.08726,-34.901048],[173.111973,-34.935674],[173.142697,-34.983542],[173.168519,-35.0391],[173.175836,-35.076485],[173.176164,-35.096111],[173.172919,-35.120451],[173.169038,-35.136031],[173.158632,-35.154705],[173.143554,-35.171689],[173.136714,-35.176033],[173.13056,-35.178932],[173.120699,-35.179112],[173.112523,-35.171837],[173.096487,-35.17294],[173.086357,-35.167653],[173.071033,-35.164345],[173.061559,-35.170683],[173.054013,-35.191769],[173.077913,-35.209466],[173.080504,-35.208831],[173.080019,-35.210597],[173.092163,-35.221466],[173.095256,-35.221172],[173.094132,-35.222865],[173.097328,-35.227115],[173.109745,-35.235845],[173.107872,-35.237001],[173.109628,-35.241659],[173.114542,-35.244898],[173.112753,-35.245533],[173.114442,-35.248398],[173.120385,-35.253281],[173.12365,-35.253126],[173.163085,-35.292562],[173.158604,-35.294437],[173.156398,-35.300532],[173.160832,-35.306219],[173.160787,-35.310342],[173.163126,-35.309961],[173.164521,-35.312648],[173.162167,-35.314749],[173.168268,-35.314948],[173.173863,-35.325632],[173.177516,-35.325263],[173.187827,-35.333628],[173.18923,-35.337681],[173.187419,-35.339227],[173.190406,-35.34205],[173.189097,-35.344206],[173.195044,-35.348232],[173.198396,-35.347609],[173.198501,-35.354434],[173.20332,-35.35522],[173.210651,-35.363692],[173.213047,-35.377632],[173.220458,-35.38126],[173.221766,-35.385954],[173.224464,-35.385135],[173.225775,-35.387779],[173.227498,-35.385438],[173.238295,-35.391533],[173.241064,-35.395664],[173.239774,-35.399761],[173.253287,-35.406961],[173.267072,-35.423902],[173.271072,-35.425443],[173.269429,-35.427029],[173.270971,-35.429946],[173.280365,-35.435446],[173.278591,-35.437106],[173.346222,-35.513568],[173.366092,-35.532105],[173.367004,-35.53757],[173.364029,-35.540566],[173.366454,-35.54307],[173.365181,-35.547402],[173.373469,-35.551194],[173.376597,-35.557613],[173.375334,-35.562277],[173.389692,-35.570858],[173.391609,-35.575357],[173.422275,-35.601533],[173.429209,-35.61748],[173.433608,-35.618386],[173.435212,-35.625108],[173.440677,-35.628325],[173.440215,-35.638811],[173.459795,-35.651349],[173.478969,-35.672029],[173.485376,-35.674545],[173.477128,-35.664854],[173.490302,-35.659689],[173.49489,-35.646586],[173.497347,-35.645747],[173.499291,-35.648411],[173.506501,-35.635445],[173.518087,-35.638534],[173.523201,-35.635523],[173.528777,-35.638859],[173.527887,-35.644344],[173.533302,-35.644957],[173.531696,-35.647271],[173.535231,-35.646448],[173.540002,-35.651559],[173.570218,-35.652652],[173.57554,-35.649704],[173.575108,-35.646309],[173.582616,-35.645314],[173.58571,-35.646217],[173.584877,-35.648603],[173.588808,-35.651296],[173.593275,-35.650369],[173.597817,-35.653498],[173.598653,-35.603575],[173.66443,-35.603995],[173.664383,-35.599645],[173.668831,-35.598186],[173.678925,-35.602371],[173.694925,-35.602881],[173.717162,-35.599952],[173.724942,-35.595912],[173.730916,-35.597665],[173.735997,-35.604247],[173.741459,-35.595962],[173.747002,-35.597452],[173.758694,-35.594996],[173.765959,-35.606668],[173.770659,-35.604914],[173.770717,-35.595536],[173.773227,-35.594927],[173.784732,-35.598125],[173.788154,-35.60138],[173.791537,-35.600353],[173.802313,-35.606704],[173.801734,-35.60864],[173.819615,-35.614243],[173.828712,-35.623221],[173.846508,-35.623918],[173.841547,-35.614884],[173.921468,-35.615642],[173.914299,-35.603769],[173.915747,-35.601974],[173.920532,-35.605232],[173.925245,-35.603019],[173.935462,-35.593182],[173.938317,-35.600298],[173.949939,-35.602596],[173.956523,-35.601446],[173.965713,-35.593308],[173.971515,-35.593208],[173.98917,-35.584206],[174.016823,-35.5907],[174.053102,-35.575734],[174.046838,-35.561579],[174.096419,-35.561958],[174.098573,-35.563963],[174.098656,-35.559243],[174.114227,-35.559362],[174.111543,-35.551443],[174.128627,-35.5515],[174.128538,-35.562679],[174.141432,-35.561652],[174.144665,-35.556952],[174.150296,-35.55555],[174.150451,-35.546176],[174.146004,-35.545077],[174.146428,-35.540843],[174.151598,-35.541265],[174.158899,-35.537978],[174.160053,-35.532326],[174.16271,-35.532351],[174.162772,-35.516895],[174.187811,-35.517782],[174.187775,-35.514843],[174.200658,-35.520169],[174.202794,-35.515009],[174.20492,-35.515992],[174.204048,-35.519856],[174.20802,-35.520148],[174.210177,-35.516652],[174.208985,-35.513359],[174.21198,-35.512107],[174.209838,-35.511531],[174.209537,-35.5069],[174.204962,-35.506685],[174.207027,-35.504294],[174.205089,-35.504118],[174.204459,-35.500529],[174.210844,-35.49874],[174.21458,-35.500171],[174.215555,-35.483474],[174.23071,-35.483572],[174.23096,-35.47403],[174.234722,-35.472122],[174.233041,-35.469684],[174.236927,-35.467825],[174.237281,-35.461061],[174.241808,-35.458102],[174.241788,-35.446635],[174.246394,-35.435878],[174.265936,-35.437314],[174.266035,-35.42799],[174.255173,-35.422417],[174.256899,-35.417093],[174.253521,-35.412675],[174.257917,-35.410183],[174.260361,-35.405317],[174.277631,-35.397848],[174.286912,-35.386728],[174.286265,-35.353617],[174.281262,-35.35423],[174.276963,-35.347548],[174.262855,-35.34008],[174.262919,-35.32035],[174.257239,-35.319503],[174.253516,-35.306475],[174.258458,-35.301717],[174.288876,-35.320036],[174.304633,-35.302073],[174.313102,-35.299748],[174.311776,-35.296493],[174.307459,-35.296767],[174.304149,-35.294139],[174.304134,-35.291094],[174.297208,-35.284151],[174.294055,-35.28408],[174.294143,-35.278447],[174.290573,-35.276969],[174.289913,-35.2739],[174.294301,-35.269321],[174.292664,-35.265818],[174.294093,-35.26117],[174.298258,-35.259122],[174.296833,-35.255577],[174.300519,-35.255895],[174.301798,-35.253772],[174.312415,-35.255905],[174.323752,-35.25406],[174.325693,-35.248309],[174.317763,-35.250082],[174.316216,-35.247914],[174.306919,-35.247607],[174.303534,-35.25298],[174.294606,-35.25388],[174.292848,-35.249798],[174.301622,-35.247748],[174.299798,-35.243555],[174.305901,-35.239368],[174.311997,-35.239069],[174.312763,-35.236641],[174.304953,-35.236026],[174.300314,-35.240841],[174.299542,-35.23736],[174.293047,-35.235822],[174.291064,-35.232137],[174.2953,-35.230266],[174.297473,-35.224089],[174.302363,-35.222022],[174.305585,-35.224673],[174.305538,-35.216443],[174.308659,-35.214892],[174.315026,-35.220552],[174.316189,-35.218642],[174.313838,-35.216352],[174.319197,-35.212721],[174.309948,-35.211503],[174.307747,-35.20907],[174.313431,-35.202511],[174.317563,-35.203001],[174.315844,-35.20057],[174.318426,-35.194961],[174.327991,-35.197542],[174.33292,-35.192658],[174.340411,-35.190988],[174.341457,-35.188606],[174.335941,-35.18795],[174.338065,-35.184562],[174.336258,-35.182022],[174.332061,-35.1815],[174.334267,-35.177201],[174.332764,-35.171867],[174.339492,-35.168111],[174.341168,-35.163333],[174.13668,-35.156335],[174.132859,-35.152928],[174.118359,-35.157023],[174.114173,-35.156401],[174.112461,-35.152122],[174.106758,-35.153388],[174.09756,-35.150929],[174.096334,-35.146936],[174.098927,-35.143908],[174.094576,-35.142255],[174.096012,-35.139982],[174.092818,-35.136775],[174.094625,-35.134753],[174.0863,-35.129584],[174.090232,-35.12678],[174.084697,-35.124839],[174.082452,-35.119089],[174.074587,-35.114918],[174.068998,-35.117869],[174.053626,-35.115773],[174.053506,-35.119046],[174.049368,-35.120632],[174.046396,-35.116749],[174.043743,-35.117879],[174.042536,-35.116117],[174.039387,-35.118357],[174.035924,-35.116215],[174.02311,-35.119285],[174.019503,-35.114805],[174.012407,-35.12213],[174.000237,-35.121756],[173.994411,-35.116015],[173.991641,-35.116249],[173.991669,-35.11956],[173.98831,-35.117413],[173.986119,-35.120869],[173.97913,-35.121846],[173.975801,-35.1198],[173.977077,-35.117206],[173.974551,-35.119519],[173.970463,-35.117036],[173.964919,-35.119665],[173.95341,-35.107995],[173.95102,-35.108503],[173.945278,-35.103979],[173.936004,-35.08947],[173.936392,-35.084778],[173.927182,-35.064089],[173.928735,-35.059005],[173.932712,-35.059812],[173.934254,-35.053764],[173.938558,-35.052893],[173.924776,-35.042975],[173.919095,-35.042666],[173.913957,-35.038858],[173.914014,-35.031945],[173.919936,-35.02681],[173.913283,-35.027578],[173.907275,-35.024424],[173.905953,-35.020876],[173.899727,-35.020735],[173.899099,-35.012917],[173.896585,-35.009772],[173.892888,-35.009835],[173.895201,-35.013261],[173.883991,-35.022414],[173.879285,-35.017923],[173.873102,-35.017117],[173.866906,-35.021348],[173.859636,-35.019212],[173.858207,-35.015812],[173.860607,-35.013838],[173.852577,-35.013133],[173.850618,-35.009814],[173.852848,-35.001417],[173.845117,-35.001881],[173.84359,-34.998678],[173.850356,-34.994952],[173.858997,-34.993904],[173.861383,-34.989735],[173.854067,-34.990417],[173.852197,-34.993935],[173.840455,-34.994025],[173.828141,-35.001854],[173.822548,-34.999843],[173.822986,-34.994044],[173.817328,-34.992337],[173.818597,-34.996761],[173.816282,-34.998374],[173.814337,-34.997151],[173.814318,-34.991613],[173.812121,-34.992005],[173.808408,-34.995445],[173.802523,-34.995463],[173.804086,-34.997676],[173.801583,-34.998386],[173.801427,-35.001451],[173.790195,-35.000905],[173.78916,-35.004264],[173.78741,-35.004524],[173.788538,-35.002831],[173.777445,-35.008217],[173.75181,-34.996965],[173.737733,-34.993535],[173.716577,-34.997537],[173.70963,-34.990297],[173.715401,-34.979424],[173.705235,-34.974339],[173.703277,-34.970808],[173.706254,-34.968645],[173.701846,-34.966312],[173.702215,-34.962691],[173.705912,-34.960523],[173.703328,-34.957832],[173.704883,-34.953892],[173.681783,-34.94792],[173.677687,-34.950876],[173.67898,-34.958236],[173.675917,-34.960711],[173.670146,-34.961779],[173.66328,-34.958987],[173.655513,-34.966772],[173.652616,-34.966663],[173.651933,-34.963991],[173.651297,-34.965926],[173.644032,-34.966194],[173.639571,-34.95983],[173.641863,-34.955635],[173.640118,-34.954239],[173.633499,-34.955587],[173.626919,-34.949544],[173.625315,-34.953051],[173.620185,-34.951987],[173.620763,-34.948107],[173.623774,-34.947922],[173.620522,-34.943702],[173.621356,-34.939107],[173.617719,-34.939894],[173.614099,-34.937303],[173.611776,-34.94103],[173.609074,-34.94119],[173.596636,-34.933845],[173.591216,-34.937572],[173.590389,-34.941627],[173.584452,-34.939834],[173.578816,-34.944885],[173.57368,-34.943868],[173.571928,-34.940134],[173.57502,-34.939088],[173.57271,-34.935446],[173.57802,-34.935437],[173.568283,-34.92784],[173.569897,-34.923367],[173.566205,-34.925191],[173.562635,-34.921568],[173.558888,-34.914141],[173.55491,-34.922737],[173.557686,-34.92579],[173.556945,-34.929386],[173.55123,-34.927273],[173.550375,-34.932483],[173.540967,-34.938787],[173.538078,-34.935708],[173.536567,-34.939518],[173.533213,-34.939451],[173.527341,-34.944359],[173.526291,-34.950923],[173.530958,-34.959356],[173.53014,-34.964221],[173.537491,-34.966976],[173.53853,-34.970609],[173.53335,-34.976801],[173.52885,-34.976484],[173.52853,-34.978567],[173.532168,-34.979999],[173.524542,-34.980392],[173.524638,-34.98315],[173.519859,-34.983544],[173.521133,-34.985301],[173.518426,-34.988652],[173.50799,-34.990316],[173.499783,-34.987585],[173.497959,-34.989479],[173.502152,-34.990995],[173.495697,-34.991852],[173.473197,-34.987915],[173.469734,-34.991195],[173.471315,-34.993048],[173.467813,-34.993575],[173.460987,-34.992214],[173.452967,-34.984493],[173.449391,-34.986867],[173.441282,-34.982689],[173.439984,-34.984768],[173.432321,-34.985567],[173.418074,-34.977738],[173.398426,-34.962156],[173.387598,-34.950894],[173.380584,-34.938822],[173.371543,-34.915015],[173.371036,-34.891225],[173.373021,-34.881561],[173.3807,-34.874755],[173.384161,-34.876914],[173.390065,-34.875179],[173.390646,-34.877471],[173.397742,-34.877656],[173.399987,-34.878769],[173.398451,-34.881779],[173.404774,-34.879594],[173.41359,-34.880852],[173.425355,-34.874895],[173.429961,-34.869257],[173.434605,-34.868979],[173.433425,-34.866262],[173.436078,-34.866129],[173.434808,-34.863133],[173.437682,-34.862604],[173.437004,-34.860641],[173.44713,-34.862773],[173.452679,-34.862635],[173.452955,-34.860081],[173.462274,-34.860136],[173.459896,-34.852651],[173.470032,-34.849494],[173.464615,-34.844995],[173.459829,-34.848041],[173.457827,-34.844542],[173.441071,-34.835952],[173.440879,-34.831992],[173.449866,-34.831781],[173.451974,-34.829145],[173.450106,-34.825117],[173.444883,-34.828311],[173.438591,-34.827409],[173.436115,-34.830245],[173.427615,-34.824981],[173.423727,-34.826402],[173.426883,-34.83022],[173.422381,-34.833155],[173.416323,-34.835097],[173.411494,-34.832838],[173.410653,-34.829575],[173.414659,-34.827561],[173.407646,-34.828065],[173.407288,-34.823014],[173.41422,-34.822116],[173.417485,-34.816445],[173.407347,-34.810921],[173.410365,-34.810463],[173.406804,-34.804118],[173.408181,-34.799418],[173.413008,-34.79719],[173.40398,-34.791566],[173.400819,-34.78709],[173.402773,-34.784931],[173.396621,-34.78224],[173.397808,-34.787836],[173.396234,-34.786767],[173.396949,-34.790008],[173.394769,-34.791651],[173.397616,-34.79808],[173.392329,-34.801362],[173.385756,-34.800429],[173.389294,-34.807699],[173.386012,-34.812343],[173.395143,-34.815738],[173.396682,-34.821659],[173.392617,-34.830568],[173.386014,-34.837573],[173.367717,-34.848489],[173.338672,-34.857704],[173.331502,-34.856754],[173.324892,-34.861004],[173.299313,-34.862628],[173.290099,-34.858369],[173.289386,-34.861474],[173.286123,-34.862362],[173.290231,-34.865111],[173.287047,-34.869846],[173.290422,-34.877099],[173.276375,-34.887879],[173.262764,-34.881225],[173.219248,-34.877581],[173.199142,-34.871143],[173.183761,-34.862788],[173.164686,-34.848395],[173.154731,-34.834274],[173.153726,-34.823557],[173.167809,-34.825459],[173.17143,-34.819826],[173.164093,-34.81327],[173.164727,-34.804555],[173.169787,-34.801802],[173.174608,-34.804514],[173.165529,-34.788762],[173.151752,-34.788211],[173.146436,-34.778831],[173.149642,-34.771794],[173.155518,-34.771928],[173.153453,-34.769979],[173.155026,-34.766369],[173.153299,-34.765393],[173.147118,-34.770275],[173.131971,-34.762943],[173.11708,-34.744539],[173.116197,-34.736766],[173.097334,-34.727825],[173.097523,-34.725577],[173.093933,-34.725735],[173.092195,-34.721733],[173.086085,-34.723443],[173.07747,-34.718207],[173.069558,-34.708341],[173.058566,-34.702455],[173.030221,-34.662897],[173.011331,-34.622568],[172.99566,-34.567705],[172.987592,-34.521482],[172.989042,-34.517707],[172.999263,-34.515662],[173.007355,-34.509193],[173.003308,-34.506818],[172.999946,-34.492696],[173.003199,-34.481489],[173.00616,-34.4814],[173.002476,-34.472872],[173.006935,-34.472341],[173.008248,-34.468622],[173.003176,-34.464958],[173.004551,-34.448708],[173.007157,-34.44752],[173.00702,-34.440865],[173.014442,-34.424137],[173.023601,-34.421383],[173.024127,-34.416673],[173.030866,-34.414094],[173.048179,-34.411644],[173.030503,-34.397267],[173.013246,-34.39263]]]]}}]};

  function isGeoJSONExpired() {
    const saved = localStorage.getItem(GEOJSON_TIMESTAMP_KEY);
    if (!saved) return true;
    const age = (Date.now() - parseInt(saved)) / (1000 * 60 * 60);
    return age > GEOJSON_EXPIRY_HOURS;
  }

  async function loadFarNorthGeoJSON() {
    if (!isGeoJSONExpired()) {
      try {
        const stored = JSON.parse(localStorage.getItem(GEOJSON_KEY));
        if (stored?.type === "FeatureCollection") return stored;
      } catch {
        console.warn("Corrupted GeoJSON in cache.");
      }
    }

    try {
      const proxy = "https://corsproxy.io/?";
      const url = "https://raw.githubusercontent.com/almokinsgov/NZSHAPE/main/far_north.geojson";
      const res = await fetch(proxy + encodeURIComponent(url));
      const json = await res.json();
      localStorage.setItem(GEOJSON_KEY, JSON.stringify(json));
      localStorage.setItem(GEOJSON_TIMESTAMP_KEY, Date.now().toString());
      return json;
    } catch (e) {
      console.warn("Failed to fetch live GeoJSON, using embedded fallback.");
      localStorage.setItem(GEOJSON_KEY, JSON.stringify(embeddedGeoJSON));
      localStorage.setItem(GEOJSON_TIMESTAMP_KEY, Date.now().toString());
      return embeddedGeoJSON;
    }
  }

  // Export function globally under `MapModule`
  global.MapModule = {
    loadFarNorthGeoJSON
  };
})(window);
